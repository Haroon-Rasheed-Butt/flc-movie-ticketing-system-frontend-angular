<form class="cart-toolbar" [formGroup]="checkoutForm">
  <mat-form-field appearance="fill">
    <mat-label>Account</mat-label>
    <mat-select formControlName="accountId">
      <mat-option *ngFor="let account of sampleAccounts" [value]="account.id">
        {{ account.label }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <button mat-stroked-button color="primary" type="button" (click)="loadCart()">Refresh cart</button>
</form>

<div *ngIf="isLoading" class="loading">
  <mat-progress-spinner diameter="36" mode="indeterminate"></mat-progress-spinner>
</div>

<div class="cart-list" *ngIf="!isLoading && cartItems.length">
  <mat-card *ngFor="let item of cartItems" class="cart-item">
    <mat-card-title>{{ item.movieName }}</mat-card-title>
    <mat-card-subtitle>Qty: {{ item.quantity }} · ₹{{ item.ticketPrice.toFixed(2) }}</mat-card-subtitle>
    <p>Purchased: {{ item.purchased ? 'Yes' : 'No' }}</p>
  </mat-card>
</div>

<div class="empty" *ngIf="!isLoading && cartItems.length === 0">
  Cart is empty. Add a movie from the home page.
</div>

<section class="checkout-panel">
  <h2>Checkout</h2>
  <p>Pending items: {{ cartItems.length }}</p>
  <p class="total">Total estimate: ₹{{ totalAmount.toFixed(2) }}</p>
  <button mat-raised-button color="accent" (click)="checkout()" [disabled]="cartItems.length === 0">Complete checkout</button>
  <div *ngIf="checkoutResult" class="result">
    <p>Processed {{ checkoutResult.processedItems }} items</p>
    <p>Total charged: ₹{{ checkoutResult.totalAmount.toFixed(2) }}</p>
  </div>
</section>
